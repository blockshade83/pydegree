{% extends "./base.html" %}
{% load static %}
{% load bootstrap5 %}

{% block content %}

  <!-- <img src="{% static 'skillsapp/background-1.jpeg' %}" style="max-width:20%;"> -->

<div class="container bg-light p-3">
  <div class="row">

    <div class="col p-3">

      <h4>Filter Jobs</h4><br><br>

      <form action="{% url 'index' %}" method = "POST" enctype="multipart/form-data">
        {% csrf_token %}

      <p>City</p>
      <select name="city_select" id="city_select" style="width: 75%;">
        {% if not city_selection %}
          <option selected disabled> -- select a City -- </option>
        {% endif %}
        {% for city in cities %}
          {% if city == city_selection %}
            <option selected>{{ city }}</option>
          {% else %}
            <option>{{ city }}</option>
          {% endif %}
        {% endfor %}
      </select>
      <br><br>

      <p>Organization</p>
      <select name="org_select" id="org_select" style="width: 75%;">
        {% if not org_selection %}
          <option selected disabled> -- select an Organization -- </option>
        {% endif %}
        {% for org in organizations %}
          {% if org == org_selection %}
            <option selected>{{ org }}</option>
          {% else %}
            <option>{{ org }}</option>
          {% endif %}
        {% endfor %}
      </select>
      <br><br>

        <input type="submit" name="submit" value="Apply filters"/>
      </form>
      <br><br>

      <form action="{% url 'index' %}" method = "GET" value={{request.GET.keyword}}>
        <input type="text" name="keyword" value="{{request.GET.keyword}}" placeholder="Search job descriptions" style="width: 75%;"/>
        <br><br>
        <input type="submit" name="submit" value="Search"/>
      </form>

    </div>

    <div class="col-6 rounded border p-3 bg-white">

      <h4>Job Postings</h4></br></br>
      {% if user.is_authenticated %}
      {% else %}
      {% endif %}

      <hr>

      {% for posting in postings %}
        <div class="row rounded p-1 mt-1 mx-1" >
          <p>{{ posting.org_name }}</p>
          <a href='{% url "view_posting" posting.id %}'> {{ posting.title }} </a>
          <p>{{ posting.city }}, {{ posting.country }}</p>
          <a href='{{ posting.posting_url }}'> {{ posting.posting_url }} </a>
          <p>{{ posting.contact_details }}</p>
          <p>Last updated: {{ posting.last_updated_on }}</p>
          <p>Skills:
            {% for posting_skill in posting.skills %}
              {{ posting_skill.skill_name }};
            {% endfor %}
          </p>
          <hr>
        </div>
      {% endfor %}
    </div>

    <div class="col"></div>

  </div>
</div>

<script type="text/javascript">
  $(document).ready(function() {
    $('#city_select').chosen();
  });
  $(document).ready(function() {
    $('#org_select').chosen();
  });
</script>

{% endblock content%}
